%! Author = Mateusz
%! Date = 26/11/2025

\subsection{Endpointy systemu}
\label{subsec:endpointy-systemu}

\newcounter{endpoint}[chapter]
\renewcommand{\theendpoint}{\thechapter.\arabic{endpoint}}

\newcommand{\epid}[1]{\textbf{ID endpointu:} & #1 \\ \hline}
\newcommand{\epurl}[1]{\textbf{URL:} & #1 \\ \hline}
\newcommand{\epname}[1]{\textbf{Nazwa:} & #1 \\ \hline}
\newcommand{\epinput}[1]{\textbf{Co przyjmuje:} & #1 \\ \hline}
\newcommand{\epquery}[1]{\textbf{Query params:} & #1 \\ \hline}
\newcommand{\epresponse}[1]{\textbf{Response codes:} & #1 \\ \hline}
\newcommand{\epoutput}[1]{\textbf{Co zwraca:} & #1 \\ \hline}

\newenvironment{tabitemize}[1][]{%
    \begin{itemize}[
        leftmargin=*,
        nosep,
        topsep=0pt,
        partopsep=0pt,
        parsep=0pt,
        itemsep=0pt,
        before=\vspace*{-0.6\baselineskip},
        #1
    ]
}{%
    \end{itemize}
}

\newcommand{\cardendpoint}[7]{%
    \refstepcounter{endpoint}%
    \par\begin{center}
    \renewcommand{\arraystretch}{1.15}%
    \begin{tabularx}{\textwidth}{|>{\columncolor{lightgray}\raggedright\arraybackslash}p{0.2\textwidth}|X|}
    \rowcolor{lightgray}
    \multicolumn{2}{|c|}{\textbf{ENDPOINT API}} \\ \hline
    \epid{#1}
    \epurl{#2}
    \epname{#3}
    \epinput{#4}
    \epquery{#5}
    \epresponse{#6}
    \epoutput{#7}
    \end{tabularx}
    \vspace{3pt}
    \textbf{Tabela \theendpoint:} Karta endpointu: #2\label{#1}
    \end{center}%
    \addcontentsline{lot}{table}{Tabela \theendpoint: Karta endpointu: #2}%
}

\noindent\textbf{Panel użytkownika}

\cardendpoint
{EP01}
{/user-dashboard/profile}
{Pobierz własny profil użytkownika}
{Brak}
{Brak}
{200 OK, 404 Not Found, 401 Unauthorized}
{%
    \begin{tabitemize}
        \item \textbf{username}: String
        \item \textbf{profilePhoto}: String (URL)
        \item \textbf{followersCount}: Integer
        \item \textbf{followedCount}: Integer
        \item \textbf{friendsCount}: Integer
        \item \textbf{photosCount}: Integer
        \item \textbf{mostPopularPhotos}: List<ImageDto>
    \end{tabitemize}
}

\cardendpoint {EP02} {/public/user-dashboard/profile/\{targetUsername\}} {Pobierz profil innego użytkownika (widok publiczny)} {%
    \begin{tabitemize}
        \item \textbf{targetUsername}: String (nazwa użytkownika w ścieżce URL)
    \end{tabitemize}
} {Brak} {200 OK, 404 Not Found} {%
    \begin{tabitemize}
        \item \textbf{profile}: UserProfileDto, zawiera m.in.:
        \begin{itemize}
            \item \textbf{username}: String
            \item \textbf{profilePhoto}: String (URL)
            \item \textbf{followersCount}: Integer
            \item \textbf{followedCount}: Integer
            \item \textbf{friendsCount}: Integer
            \item \textbf{photosCount}: Integer
            \item \textbf{mostPopularPhotos}: List<ImageDto>
        \end{itemize}
        \item \textbf{friendStatus}: UserFriendStatus
        \item \textbf{isFollowing}: Boolean
        \item \textbf{isOwnProfile}: Boolean
    \end{tabitemize}
}

\cardendpoint {EP03} {/user-dashboard/profile} {Zmień zdjęcie profilowe użytkownika} {%
    \begin{tabitemize}
        \item \textbf{profilePhoto}: MultipartFile (nowe zdjęcie profilowe)
    \end{tabitemize}
} {Brak} {200 OK, 404 Not Found, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP04} {/user-dashboard/friends} {Pobierz listę znajomych zalogowanego użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>, gdzie każdy element zawiera:
        \begin{itemize}
            \item \textbf{username}: String
            \item \textbf{profilePhoto}: String (URL)
            \item \textbf{commonPrivateChatId}: Long (opcjonalne)
            \item \textbf{isUserFriend}: boolean
            \item \textbf{status}: UserFriendStatus
        \end{itemize}
        \item \textbf{hasNext}: boolean (czy istnieje kolejna strona wyników)
    \end{tabitemize}
}

\cardendpoint {EP05} {/public/user-dashboard/friends/\{targetUsername\}} {Pobierz listę znajomych innego użytkownika (widok publiczny)} {%
    \begin{tabitemize}
        \item \textbf{targetUsername}: String (nazwa użytkownika w ścieżce URL)
    \end{tabitemize}
} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP06} {/user-dashboard/friends} {Edytuj relację znajomości z użytkownikiem} {Brak} {%
    \begin{tabitemize}
        \item \textbf{friendUsername}: String (nazwa użytkownika)
        \item \textbf{type}: UserRelationEditType (typ operacji, np. dodanie/wycofanie zaproszenia, usunięcie znajomego)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 404 Not Found, 409 Conflict, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP07} {/user-dashboard/friends/change-status} {Zmień status znajomego} {Brak} {%
    \begin{tabitemize}
        \item \textbf{friendUsername}: String (nazwa użytkownika)
        \item \textbf{status}: UserFriendStatus (nowy status relacji)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 404 Not Found, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP08} {/user-dashboard/followers} {Pobierz obserwujących zalogowanego użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP09} {/public/user-dashboard/followers/\{targetUsername\}} {Pobierz obserwujących wybranego użytkownika (widok publiczny)} {%
    \begin{tabitemize}
        \item \textbf{targetUsername}: String
    \end{tabitemize}
} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP10} {/user-dashboard/followed} {Pobierz obserwowanych przez zalogowanego użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP11} {/public/user-dashboard/followed/\{targetUsername\}} {Pobierz obserwowanych wybranego użytkownika (widok publiczny)} {%
    \begin{tabitemize}
        \item \textbf{targetUsername}: String
    \end{tabitemize}
} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP12} {/user-dashboard/friends/find} {Wyszukaj użytkowników po nazwie użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{query}: String (fraza wyszukiwania)
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP13} {/user-dashboard/friends/invites} {Pobierz wszystkie zaproszenia do znajomych} {Brak} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<SocialDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP14} {/user-dashboard/followed} {Edytuj listę obserwowanych użytkowników} {Brak} {%
    \begin{tabitemize}
        \item \textbf{followedUsername}: String (nazwa użytkownika)
        \item \textbf{type}: UserRelationEditType (typ operacji)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 404 Not Found, 409 Conflict, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP15} {/user-dashboard/favorite-spots} {Pobierz listę ulubionych spotów użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{type}: FavoriteSpotsListType (typ listy, np. ulubione/odwiedzone)
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 10)
    \end{tabitemize}
} {200 OK, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<FavoriteSpotDto>, gdzie każdy element zawiera:
        \begin{itemize}
            \item \textbf{id}: Long
            \item \textbf{name}: String
            \item \textbf{country}: String
            \item \textbf{city}: String
            \item \textbf{description}: String
            \item \textbf{rating}: Double
            \item \textbf{viewsCount}: Integer
            \item \textbf{imageUrl}: String (URL)
            \item \textbf{type}: FavoriteSpotsListType
            \item \textbf{coords}: SpotCoordinatesDto
            \item \textbf{tags}: Set<SpotTagDto>
        \end{itemize}
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP16} {/user-dashboard/favorite-spots} {Modyfikuj listę ulubionych spotów użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{type}: FavoriteSpotsListType
        \item \textbf{spotId}: Long (identyfikator spotu)
        \item \textbf{operationType}: FavouriteSpotListOperationType (typ operacji, np. dodanie/usunięcie)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP17} {/user-dashboard/add-spot-media} {Dodaj media do istniejącego spotu użytkownika} {%
    \begin{tabitemize}
        \item \textbf{mediaFiles}: List<MultipartFile> (lista plików multimedialnych)
    \end{tabitemize}
} {%
    \begin{tabitemize}
        \item \textbf{spotId}: Long (identyfikator spotu)
    \end{tabitemize}
} {200 OK, 404 Not Found, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP18} {/user-dashboard/is-spot-favourite} {Sprawdź, czy spot jest w ulubionych użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{spotId}: Long (identyfikator spotu)
    \end{tabitemize}
} {200 OK, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{isFavouriteSpot}: boolean
    \end{tabitemize}
}

\cardendpoint {EP19} {/user-dashboard/photos} {Pobierz posortowane zdjęcia użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{type}: DateSortType (typ sortowania po dacie)
        \item \textbf{from}: LocalDate (opcjonalnie, data od)
        \item \textbf{to}: LocalDate (opcjonalnie, data do)
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<DatedMediaGroupDto>, gdzie:
        \begin{itemize}
            \item \textbf{date}: LocalDate (data grupy)
            \item \textbf{media}: List<MediaDto>, każdy element:
            \begin{itemize}
                \item \textbf{src}: String (URL/ścieżka do pliku)
                \item \textbf{heartsCount}: Integer
                \item \textbf{viewsCount}: Integer
                \item \textbf{id}: Long
            \end{itemize}
        \end{itemize}
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP20} {/user-dashboard/comments} {Pobierz posortowane komentarze użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{type}: DateSortType (typ sortowania po dacie)
        \item \textbf{from}: LocalDate (opcjonalnie, data od)
        \item \textbf{to}: LocalDate (opcjonalnie, data do)
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<DatedCommentsGroupDto>, gdzie:
        \begin{itemize}
            \item \textbf{date}: LocalDate (data)
            \item \textbf{spotName}: String (nazwa spotu)
            \item \textbf{comments}: List<CommentDto>, każdy element:
            \begin{itemize}
                \item \textbf{addTime}: LocalTime (HH:mm)
                \item \textbf{id}: Long
                \item \textbf{text}: String
                \item \textbf{spotName}: String
            \end{itemize}
        \end{itemize}
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP21} {/user-dashboard/settings} {Edytuj ustawienia konta użytkownika} {%
    \begin{tabitemize}
        \item \textbf{UserEditDataDto}: JSON z danymi do zmiany (np. nazwa użytkownika, e-mail, hasło itd.)
    \end{tabitemize}
} {Brak} {200 OK, 400 Bad Request, 403 Forbidden, 404 Not Found, 409 Conflict, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP22} {/user-dashboard/settings} {Pobierz dane konta użytkownika} {Brak} {Brak} {200 OK, 404 Not Found, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{username}: String
        \item \textbf{email}: String
        \item \textbf{provider}: Provider (np. lokalny, Google)
    \end{tabitemize}
}

\cardendpoint {EP23} {/user-dashboard/movies} {Pobierz posortowane filmy użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{type}: DateSortType (typ sortowania po dacie)
        \item \textbf{from}: LocalDate (opcjonalnie, data od)
        \item \textbf{to}: LocalDate (opcjonalnie, data do)
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<DatedMediaGroupDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP24} {/user-dashboard/photos/\{targetUsername\}} {Pobierz wszystkie zdjęcia wybranego użytkownika} {%
    \begin{tabitemize}
        \item \textbf{targetUsername}: String
    \end{tabitemize}
} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 400 Bad Request, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{items}: List<DatedMediaGroupDto>
        \item \textbf{hasNext}: boolean
    \end{tabitemize}
}

\cardendpoint {EP25} {/user-dashboard/add-spot} {Pobierz listę spotów dodanych przez użytkownika} {Brak} {%
    \begin{tabitemize}
        \item \textbf{page}: Integer (opcjonalnie, domyślnie 0)
        \item \textbf{size}: Integer (opcjonalnie, domyślnie 20)
    \end{tabitemize}
} {200 OK, 401 Unauthorized} {%
    \begin{itemize}
        \item \textbf{items}: List<AddSpotDto>, każdy element:
        \begin{itemize}
            \item \textbf{id}: Long
            \item \textbf{name}: String
            \item \textbf{description}: String
            \item \textbf{country}: String
            \item \textbf{region}: String
            \item \textbf{city}: String
            \item \textbf{street}: String
            \item \textbf{borderPoints}: List<BorderPoint> (x, y)
            \item \textbf{firstPhotoUrl}: String (URL)
        \end{itemize}
        \item \textbf{hasNext}: boolean
    \end{itemize}
}

\cardendpoint {EP26} {/user-dashboard/add-spot} {Dodaj nowy spot użytkownika} {%
    \begin{tabitemize}
        \item \textbf{spot}: String (część multipart, JSON z danymi nowego spotu)
        \item \textbf{media}: List<MultipartFile> (część multipart, pliki multimedialne spotu)
    \end{tabitemize}
} {Brak} {200 OK, 404 Not Found, 401 Unauthorized} {Brak (pusta odpowiedź)}

\cardendpoint {EP27} {/user-dashboard/add-spot/coordinates} {Wyszukaj koordynaty lokalizacji na podstawie zapytania tekstowego} {Brak} {%
    \begin{tabitemize}
        \item \textbf{query}: String (opis lokalizacji, np. adres, nazwa miejsca)
    \end{tabitemize}
} {200 OK, 401 Unauthorized} {%
    \begin{tabitemize}
        \item \textbf{x}: Double (szerokość/długość geograficzna – składnik 1)
        \item \textbf{y}: Double (szerokość/długość geograficzna – składnik 2)
    \end{tabitemize}
}


%\begin{tabitemize}
%\item \lstinline{GET /user-dashboard/profile}
%\item \lstinline{GET /public/user-dashboard/profile/"targetUsername"}
%\item \lstinline{PATCH /user-dashboard/profile}
%\item \lstinline{GET /user-dashboard/friends}
%\item \lstinline{GET /public/user-dashboard/friends/"targetUsername"}
%\item \lstinline{PATCH /user-dashboard/friends}
%\item \lstinline{PATCH /user-dashboard/friends/change-status}
%\item \lstinline{GET /user-dashboard/followers}
%\item \lstinline{GET /public/user-dashboard/followers/"targetUsername"}
%\item \lstinline{GET /user-dashboard/followed}
%\item \lstinline{GET /public/user-dashboard/followed/"targetUsername"}
%\item \lstinline{GET /user-dashboard/friends/find}
%\item \lstinline{GET /user-dashboard/friends/invites}
%\item \lstinline{PATCH /user-dashboard/followed}
%\item \lstinline{GET /user-dashboard/favorite-spots}
%\item \lstinline{PATCH /user-dashboard/favorite-spots}
%\item \lstinline{GET /user-dashboard/photos}
%\item \lstinline{GET /user-dashboard/comments}
%\item \lstinline{PATCH /user-dashboard/settings}
%\item \lstinline{GET /user-dashboard/settings}
%\item \lstinline{GET /user-dashboard/movies}
%\item \lstinline{GET /user-dashboard/photos/"targetUsername"}
%\item \lstinline{GET /user-dashboard/add-spot}
%\item \lstinline{POST /user-dashboard/add-spot}
%\item \lstinline{GET /user-dashboard/add-spot/coordinates}
%\end{tabitemize}
%
%\noindent\textbf{Strona główna}
%
%\begin{tabitemize}
%  \item \lstinline{GET /public/spot/most-popular}
%  \item \lstinline{GET /public/spot/search/home-page}
%  \item \lstinline{GET /public/spot/search/home-page/locations}
%  \item \lstinline{GET /public/spot/search/home-page/advance}
%\end{tabitemize}
%
%\noindent\textbf{Konto użytkownika}
%
%\begin{tabitemize}
%  \item \lstinline{POST /public/account/register}
%  \item \lstinline{POST /public/account/login}
%  \item \lstinline{GET /account/login-success}
%  \item \lstinline{POST /public/account/forgot-password}
%  \item \lstinline{POST /public/account/set-new-password}
%  \item \lstinline{GET /account/check}
%\end{tabitemize}