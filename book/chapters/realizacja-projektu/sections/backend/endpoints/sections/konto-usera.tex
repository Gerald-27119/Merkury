%! Author = Mateusz
%! Date = 30/11/2025

\noindent\textbf{Konto użytkownika – rejestracja, logowanie, hasło}

\cardendpoint
{EP30}
{/public/account/register}
{Zarejestruj nowego użytkownika}
{%
    \begin{tabitemize}
        \item \textbf{body}: UserRegisterDto, zawiera:
        \begin{itemize}
            \item \textbf{username}: String
            \item \textbf{email}: String
            \item \textbf{password}: String
        \end{itemize}
    \end{tabitemize}
}
{Brak}
{201 Created, 401 Unauthorized, 409 Conflict, 422 Unprocessable Entity, 500 Internal Server Error}
{%
    \begin{tabitemize}
        \item \textbf{body}: String (komunikat)
        \item JWT tokeny ustawione w ciasteczkach HTTP-only
    \end{tabitemize}
}

\cardendpoint
{EP31}
{/public/account/login}
{Zaloguj użytkownika}
{%
    \begin{tabitemize}
        \item \textbf{body}: UserLoginDto, zawiera:
        \begin{itemize}
            \item \textbf{username}: String
            \item \textbf{password}: String
        \end{itemize}
    \end{tabitemize}
}
{Brak}
{200 OK, 401 Unauthorized, 422 Unprocessable Entity}
{%
    \begin{tabitemize}
        \item Brak (pusta odpowiedź w body)
        \item JWT tokeny zwrócone w ciasteczkach HTTP-only
    \end{tabitemize}
}

\cardendpoint
{EP32}
{/public/account/forgot-password}
{Rozpocznij procedurę resetu hasła (wyślij link na e-mail)}
{%
    \begin{tabitemize}
        \item \textbf{body}: String (adres e-mail użytkownika w treści żądania)
    \end{tabitemize}
}
{Brak}
{200 OK, 404 Not Found, 422 Unprocessable Entity, 500 Internal Server Error}
{%
    \begin{tabitemize}
        \item \textbf{body}: String (komunikat)
        \item Link resetujący hasło wysłany na podany adres e-mail
    \end{tabitemize}
}

\cardendpoint
{EP33}
{/public/account/set-new-password}
{Ustaw nowe hasło użytkownika na podstawie tokenu resetującego}
{%
    \begin{tabitemize}
        \item \textbf{body}: UserPasswordResetDto, zawiera:
        \begin{itemize}
            \item \textbf{token}: String (UUID – token resetu hasła)
            \item \textbf{password}: String
        \end{itemize}
    \end{tabitemize}
}
{Brak}
{200 OK, 400 Bad Request, 404 Not Found, 422 Unprocessable Entity}
{%
    \begin{tabitemize}
        \item \textbf{body}: String (komunikat)
    \end{tabitemize}
}

\cardendpoint
{EP34}
{/account/check}
{Sprawdź, czy użytkownik jest uwierzytelniony}
{Brak}
{Brak}
{200 OK, 401 Unauthorized, 403 Forbidden}
{%
    \begin{tabitemize}
        \item Brak (pusta odpowiedź; sam status informuje o uwierzytelnieniu)
    \end{tabitemize}
}

\cardendpoint
{EP35}
{/account/login-success}
{Obsłuż użytkownika zalogowanego przez OAuth2 i przekieruj go do aplikacji}
{%
    \begin{tabitemize}
        \item Brak klasycznego body – endpoint wywoływany jest jako redirect callback
        po poprawnym logowaniu przez dostawcę OAuth2.
        \item Kontekst użytkownika przekazywany jest w obiekcie
        \texttt{OAuth2AuthenticationToken}.
    \end{tabitemize}
}
{Brak}
{302 Found (redirect), 404 Not Found, 409 Conflict, 422 Unprocessable Entity, 500 Internal Server Error}
{%
    \begin{tabitemize}
        \item Przekierowanie użytkownika na stronę frontendową skonfigurowaną w
        \texttt{UrlsProperties.afterLoginPageUrl}.
    \end{tabitemize}
}
